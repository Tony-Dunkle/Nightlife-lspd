<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Viewport meta tag is crucial for responsive behavior across devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSPD Internal Portal - Official Member Access</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="LSPD.png">

    <!-- Open Graph (Facebook, Discord, etc.) Meta Tags -->
    <!-- Updated og:title to display "Official Nightlife LSPD Internal Web Portal" -->
    <meta property="og:title" content="Official Nightlife LSPD Internal Web Portal">
    <meta property="og:description" content="Your central hub for Los Santos Police Department resources, policies, and departmental communications.">
    <!-- Use the direct raw GitHub URL for the image for consistent loading across platforms -->
    <meta property="og:image" content="https://raw.githubusercontent.com/Tony-Dunkle/Nightlife-lspd/740c11da2aa53715804bfc13b8e3cc3762a3274d/LSPD.png">
    <meta property="og:url" content="https://your-website-url.com/index.html"> <!-- IMPORTANT: Replace with your actual deployed URL -->
    <meta property="og:type" content="website">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <!-- Updated twitter:title to display "Official Nightlife LSPD Internal Web Portal" -->
    <meta name="twitter:title" content="Official Nightlife LSPD Internal Web Portal">
    <meta name="twitter:description" content="Your central hub for Los Santos Police Department resources, policies, and departmental communications.">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/Tony-Dunkle/Nightlife-lspd/740c11da2aa53715804bfc13b8e3cc3762a3274d/LSPD.png">

    <!-- Tailwind CSS CDN - provides responsive utility classes out of the box -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for a clean, modern look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f8f8; /* Light gray background */
            color: #333; /* Dark gray text */
            opacity: 0; /* Start with body invisible for fade-in */
            transition: opacity 1s ease-in; /* Smooth transition for fade-in */
        }

            body.fade-in {
                opacity: 1; /* Fade in to full visibility */
            }

        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 5px;
        }

            ::-webkit-scrollbar-thumb:hover {
                background: #555;
            }
        /* Styles for the banner */
        .banner-container {
            position: fixed;
            top: 4rem; /* Adjust based on header height */
            right: 1rem;
            z-index: 999; /* Ensure it's on top, but below the sticky header */
            max-width: 300px; /* Limit banner width */
            transform: translateX(100%); /* Start off-screen for slide-in */
            transition: transform 0.3s ease-in-out; /* Smooth transition for showing/hiding */
        }

            .banner-container.show {
                transform: translateX(0); /* Slide in */
            }

        .banner-content {
            background-color: #fff;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .banner-close-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: none;
            border: none;
            font-size: 1.25rem;
            cursor: pointer;
            color: #666;
            transition: color 0.2s;
        }

            .banner-close-btn:hover {
                color: #333;
            }

        /* Style for the video player as a background */
        .background-video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0; /* Place behind content */
        }

            .background-video-container video {
                /* This ensures the video always covers the container, even if it means cropping */
                width: 100%;
                height: 100%;
                object-fit: cover; /* Ensures the video covers the entire area without distortion */
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%); /* Center the video */
            }

        /* Overlay for text readability */
        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Semi-transparent dark overlay */
            z-index: 1; /* Above the video, below the text content */
        }
    </style>
</head>
<body class="antialiased">

    <!-- Development Notice Banner -->
    <div id="devNoticeBanner" class="banner-container">
        <div class="banner-content">
            <button class="banner-close-btn" id="closeBannerBtn">&times;</button>
            <h3 class="text-lg font-bold text-blue-800 mb-2">Website Under Development</h3>
            <div class="flex items-center space-x-2">
                <img src="LSPD.png" alt="LSPD Logo" class="w-10 h-10 object-contain" onerror="this.onerror=null; this.src='https://raw.githubusercontent.com/Tony-Dunkle/Nightlife-lspd/740c11da2aa53715804bfc13b8e3cc3762a3274d/LSPD.png';">
                <p class="text-gray-700 text-sm">
                    Some features may not work as expected or may be missing.
                </p>
            </div>
        </div>
    </div>

    <!-- Header Section -->
    <header class="bg-blue-900 text-white shadow-lg py-4 px-6 md:px-12 flex items-center justify-between sticky top-0 z-50 rounded-b-lg relative">
        <div class="flex items-center">
            <!-- LSPD Logo -->
            <img src="LSPD.png" alt="LSPD Logo" class="mr-4 w-16 h-16 object-contain" onerror="this.onerror=null; this.src='https://raw.githubusercontent.com/Tony-Dunkle/Nightlife-lspd/740c11da2aa53715804bfc13b8e3cc3762a3274d/LSPD.png';">
            <!-- Responsive font size: text-2xl for small screens, text-3xl for medium screens and up -->
            <h1 class="text-2xl md:text-3xl font-bold">Los Santos Police Department</h1>
        </div>

        <!-- Hamburger Menu Button for Mobile -->
        <button id="hamburgerBtn" class="hamburger-menu text-white focus:outline-none md:hidden">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-4 6h4"></path>
            </svg>
        </button>

        <!-- Navigation Menu -->
        <!-- Added md:flex-grow to nav to allow it to take available space -->
        <nav class="nav-links md:flex md:flex-grow md:justify-end">
            <!-- Changed md:space-x-8 to md:space-x-4 and added md:flex-wrap for stacking -->
            <ul class="flex flex-col md:flex-row md:flex-wrap md:justify-end space-y-2 md:space-y-0 md:space-x-4 text-sm font-medium">
                <li><a href="index.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700 current-page">Dashboard</a></li>
                <li><a href="SOP.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">SOPs</a></li>
                <li><a href="training.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">Training</a></li>
                <li><a href="forms.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">Forms</a></li>
                <li><a href="roster.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">Roster</a></li>
                <li><a href="hr.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">HR Info</a></li>
                <li><a href="report.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">Report Generator</a></li>
                <li><a href="charges.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">Charge Calculator</a></li>
                <li><a href="info.html" class="nav-item-link text-blue-200 hover:text-white transition duration-300 ease-in-out py-1 px-2 rounded-md hover:bg-blue-700">Common Information</a></li>
            </ul>
        </nav>
    </header>
    <!-- Hero Section - Internal Focus -->
    <section class="relative bg-gradient-to-r from-blue-700 to-blue-900 text-white py-20 px-6 md:px-12 rounded-lg m-4 md:m-8 overflow-hidden shadow-xl">
        <!-- Local Video Player for Background -->
        <div class="background-video-container">
            <video autoplay loop muted playsinline>
                <source src="index.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="video-overlay"></div> <!-- Overlay for readability -->
        </div>
        <div class="relative z-10 text-center max-w-4xl mx-auto">
            <h2 class="text-4xl md:text-6xl font-extrabold leading-tight mb-6">Empowering Our Officers</h2>
            <p class="text-lg md:text-xl mb-8">Your central hub for LSPD resources, policies, and departmental communications. Thank you for your service.</p>
            <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6">
                <!-- Updated SOP link in hero section -->
                <a href="SOP.html" class="inline-block bg-white text-blue-800 hover:bg-blue-100 font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Access SOPs</a>
                <!-- Removed the "View Daily Briefing" button -->
            </div>
        </div>
    </section>

    <!-- Main Content Sections -->
    <main class="container mx-auto px-4 md:px-8 py-12">
        <!-- Internal Quick Links / Important Information -->
        <!-- Grid layout that changes columns based on screen size: 1 column on small, 2 on medium, 4 on large -->
        <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <div class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 ease-in-out">
                <h3 class="text-xl font-semibold text-blue-700 mb-3">Standard Operating Procedures</h3>
                <p class="text-gray-600 mb-4">Latest departmental protocols and guidelines.</p>
                <!-- Updated SOP quick link -->
                <a href="SOP.html" class="text-blue-500 hover:underline font-medium">Browse SOPs &rarr;</a>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 ease-in-out">
                <h3 class="text-xl font-semibold text-blue-700 mb-3">Training & Development</h3>
                <p class="text-gray-600 mb-4">Upcoming courses, certifications, and resources.</p>
                <!-- Updated Training quick link -->
                <a href="training.html" class="text-blue-500 hover:underline font-medium">View Schedule &rarr;</a>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 ease-in-out">
                <h3 class="text-xl font-semibold text-blue-700 mb-3">Internal Forms & Requests</h3>
                <p class="text-gray-600 mb-4">Access leave requests, equipment forms, and more.</p>
                <!-- Updated Forms quick link -->
                <a href="forms.html" class="text-blue-500 hover:underline font-medium">Download Forms &rarr;</a>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 ease-in-out">
                <h3 class="text-xl font-semibold text-blue-700 mb-3">Shift Roster & Schedules</h3>
                <p class="text-gray-600 mb-4">Check your upcoming shifts and team assignments.</p>
                <!-- Updated Roster quick link -->
                <a href="roster.html" class="text-blue-500 hover:underline font-medium">View Roster &rarr;</a>
            </div>
        </section>

        <!-- Our Internal Commitment / Values -->
        <section class="bg-blue-50 p-8 rounded-lg shadow-inner mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Our Commitment to Our Team</h2>
            <!-- Flexbox that stacks vertically on small screens and horizontally on medium screens and up -->
            <div class="flex flex-col md:flex-row items-center md:space-x-8">
                <div class="md:w-2/3">
                    <p class="text-lg text-gray-700 leading-relaxed mb-4">
                        The Los Santos Police Department is committed to providing our dedicated officers and staff with the resources, support, and training necessary to excel in their duties and maintain their well-being.
                    </p>
                    <p class="text-lg text-gray-700 leading-relaxed mb-4">
                        We foster an environment of continuous learning, mutual respect, and operational excellence, ensuring our team is equipped to uphold the highest standards of law enforcement and community service.
                    </p>
                </div>
                <div class="md:w-1/3 mt-6 md:mt-0">
                    <img src="LSPD.png" alt="LSPD Logo" class="rounded-lg shadow-md w-full h-auto object-contain" onerror="this.onerror=null; this.src='https://raw.githubusercontent.com/Tony-Dunkle/Nightlife-lspd/740c11da2aa53715804bfc13b8e3cc3762a3274d/LSPD.png';">
                </div>
            </div>
        </section>

        <!-- Dynamic Updates Section -->
        <section id="updatesSection" class="bg-gray-100 p-8 rounded-lg shadow-lg mb-12 hidden">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">Recent Website Updates</h2>
            <div id="updatesContent" class="space-y-4">
                <!-- Updates will be loaded here dynamically from CSV -->
            </div>
        </section>

    </main>

    <!-- Footer Section - Internal Contacts -->
    <footer class="bg-gray-800 text-white py-10 px-6 md:px-12 rounded-t-lg">
        <div class="container mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
                <h4 class="text-xl font-semibold mb-4 text-blue-300">Internal Contacts</h4>
                <ul class="space-y-2 text-sm">
                    <li><a href="https://discord.gg/7FwxdpfDTM" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">Discord</a></li>
                    <li><a href="https://discord.com/channels/1383775098464370768/1383775099777318972" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">UPD Chat</a></li>
                    <li><a href="https://discord.com/channels/1383775098464370768/1383782578976456735" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">Cadet Support</a></li>
                </ul>
            </div>
            <div>
                <h4 class="text-xl font-semibold mb-4 text-blue-300">Quick Access</h4>
                <ul class="space-y-2 text-sm">
                    <li><a href="https://docs.google.com/document/d/1etjilZ1dAHGviw33MV5Zs-b5dXqcSHyoYIHvHiRIyy4/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">LSPD SOP</a></li>
                    <li><a href="https://docs.google.com/document/d/1hKQ4fw9b1_yQELhPi1p1b4M6uiSaYb7bBp-9C6GVTdY/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">Los Santos Police Department Interview Procedure & Questions</a></li>
                    <li><a href="https://docs.google.com/document/d/1d004FfAhZBgESn88Mx21N3CGqXlcoNeP9_sadn_ePak/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">Promotional Pathway & Subdivision Assignment Policy</a></li>
                    <li><a href="https://docs.google.com/document/d/14QIEsYMWpTssti1xGbGWiMxQ2b0jbiYxuMmvV8XWUUo/edit?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">Highway Enforcement and Apprehension Team (HEAT) Activation Policy</a></li>
                    <li><a href="https://docs.google.com/document/d/1Ggf7SS5voiIjr3iSLB3VtAc47JN3aDjm2J_gYnpoZ6s/edit?blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">Disciplinary Guidelines</a></li>
                    <li><a href="privacypolicy.html" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white hover:underline transition duration-300 ease-in-out">Privacy Policy</a></li>
                </ul>
            </div>
            <div>
                <h4 class="text-xl font-semibold mb-4 text-blue-300">System Information</h4>
                <p class="text-gray-500 text-sm mb-2">Unauthorized Access Strictly Prohibited</p>
                <p class="text-gray-500 text-sm mb-2">For LSPD Personnel Use Only</p>
                <p class="text-500 text-sm mb-2">Created and Maintained by FiveM "NightLife RP"</p>
                <p class="text-gray-500 text-sm">&copy; 2025 Los Santos Police Department Internal Systems.</p>
            </div>
        </div>
        <!-- Font Awesome for any potential internal icons (though less needed here) -->
        <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Fade in the body content
            document.body.classList.add('fade-in');

            const banner = document.getElementById('devNoticeBanner');
            const closeBannerBtn = document.getElementById('closeBannerBtn');

            // Show the banner after a short delay to allow body fade-in
            setTimeout(() => {
                banner.classList.add('show');
            }, 500); // Adjust delay as needed

            // Function to hide the banner
            const hideBanner = () => {
                banner.classList.remove('show'); // Hide by removing 'show' class
            };

            // Event listener for closing the banner
            closeBannerBtn.addEventListener('click', hideBanner);

            // Function to fetch and display updates from CSV
            const loadUpdates = async () => {
                const updatesSection = document.getElementById('updatesSection');
                const updatesContent = document.getElementById('updatesContent');
                const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQxN1ZQBPqwqLxvr_T1tQ2TVwHuy0d2jainTySsbsSxMBl6ukf5R3Di6SGO3sHA3CD-1uSBgp_qPtJA/pub?output=csv';
                const fourteenDaysAgo = new Date();
                fourteenDaysAgo.setDate(fourteenDaysAgo.getDate() - 14);

                console.log('--- Starting loadUpdates ---');
                console.log('Current Date:', new Date().toLocaleDateString());
                console.log('14 Days Ago Date:', fourteenDaysAgo.toLocaleDateString());

                try {
                    const response = await fetch(csvUrl);
                    console.log('Fetch response status:', response.status);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const csvText = await response.text();
                    console.log('Fetched CSV Text (first 200 chars):', csvText.substring(0, 200));

                    // Simple CSV parsing (assuming format: Date,Type,Description)
                    const lines = csvText.trim().split('\n');
                    const updates = [];

                    console.log('Total CSV lines (including header):', lines.length);

                    // Skip header row
                    for (let i = 1; i < lines.length; i++) {
                        const parts = lines[i].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/); // Split by comma, but not inside quotes
                        console.log(`Processing line ${i}:`, lines[i]);
                        console.log('Parts (after regex split):', parts);

                        if (parts.length >= 3) {
                            // Remove leading/trailing quotes from date and description
                            const dateStr = parts[0].trim().replace(/"/g, '');
                            const title = parts[1].trim().replace(/"/g, ''); // Also remove quotes from title
                            const description = parts[2].trim().replace(/"/g, '');

                            const updateDate = new Date(dateStr);

                            console.log(`Date string (cleaned): "${dateStr}", Parsed Date:`, updateDate);
                            console.log('Is Date Valid (isNaN):', isNaN(updateDate));
                            console.log('Is updateDate >= fourteenDaysAgo:', updateDate >= fourteenDaysAgo);

                            // Check if the date is valid and within the last 14 days
                            if (!isNaN(updateDate) && updateDate >= fourteenDaysAgo) {
                                updates.push({ date: updateDate, title, description });
                                console.log('Update added:', { date: updateDate, title, description });
                            } else {
                                console.log('Update skipped (invalid date or too old):', { dateStr, title });
                            }
                        } else {
                            console.log('Skipping malformed line (less than 3 parts):', lines[i]);
                        }
                    }

                    // Sort updates by date in descending order (most recent first)
                    updates.sort((a, b) => b.date - a.date);

                    // Limit to 10 updates
                    const recentUpdates = updates.slice(0, 10);
                    console.log('Number of recent updates after filtering and slicing:', recentUpdates.length);
                    console.log('Recent Updates Array:', recentUpdates);

                    updatesContent.innerHTML = ''; // Clear existing content

                    if (recentUpdates.length > 0) {
                        recentUpdates.forEach(update => {
                            const updateDiv = document.createElement('div');
                            updateDiv.className = 'bg-white p-4 rounded-md shadow-sm';
                            updateDiv.innerHTML = `
                                    <p class="text-gray-800 font-semibold">${update.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}: ${update.title}</p>
                                    <p class="text-gray-600 text-sm">${update.description}</p>
                                `;
                            updatesContent.appendChild(updateDiv);
                        });
                        updatesSection.classList.remove('hidden'); // Show the section
                        console.log('Updates section is now visible.');
                    } else {
                        updatesSection.classList.add('hidden'); // Hide the section if no recent updates
                        console.log('No recent updates found. Updates section is hidden.');
                    }

                } catch (error) {
                    console.error('Error fetching or parsing updates CSV:', error);
                    updatesSection.classList.add('hidden'); // Hide the section on error
                }
                console.log('--- Finished loadUpdates ---');
            };

            // Load updates when the page loads
            loadUpdates();
        });
    </script>
</body>
</html>
